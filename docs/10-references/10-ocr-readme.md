# Universal OCR Tool - Phase 1

## æ¦‚è¿°
Universal OCR Tool æ˜¯ SimaCode çš„é€šç”¨æ–‡æ¡£è¯†åˆ«å·¥å…·ï¼Œæ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼çš„æ™ºèƒ½æ–‡æœ¬æå–ã€‚

## Phase 1 åŠŸèƒ½ âœ…

### å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½
- **é…ç½®ç®¡ç†ç³»ç»Ÿ**: æ”¯æŒ YAML é…ç½®æ–‡ä»¶
- **Claude Vision å¼•æ“**: ä½¿ç”¨ Claude-3.5 Sonnet è¿›è¡Œæ™ºèƒ½ OCR
- **æ–‡ä»¶å¤„ç†**: æ”¯æŒå›¾ç‰‡å’Œ PDF æ–‡æ¡£å¤„ç†
- **å¤šé¡µé¢æ”¯æŒ**: è‡ªåŠ¨å°† PDF è½¬æ¢ä¸ºå›¾ç‰‡å¹¶é€é¡µå¤„ç†
- **è´¨é‡å¢å¼º**: å›¾ç‰‡é¢„å¤„ç†å’Œè´¨é‡ä¼˜åŒ–
- **è¾“å…¥éªŒè¯**: å®Œæ•´çš„å‚æ•°éªŒè¯å’Œé”™è¯¯å¤„ç†
- **ç»“æœæ ¼å¼åŒ–**: æ”¯æŒ JSONã€ç»“æ„åŒ–æ–‡æœ¬ã€åŸå§‹æ–‡æœ¬è¾“å‡º

### æ”¯æŒçš„æ–‡ä»¶æ ¼å¼
- **å›¾ç‰‡**: JPG, JPEG, PNG, GIF, WebP, BMP, TIFF
- **æ–‡æ¡£**: PDF (è‡ªåŠ¨è½¬æ¢ä¸ºå›¾ç‰‡å¤„ç†)

## å®‰è£…è¦æ±‚

### å¿…éœ€ä¾èµ–
```bash
pip install anthropic  # Claude API å®¢æˆ·ç«¯
pip install pydantic   # æ•°æ®éªŒè¯
pip install PyYAML     # é…ç½®æ–‡ä»¶æ”¯æŒ
```

### å¯é€‰ä¾èµ–ï¼ˆç”¨äºå¢å¼ºåŠŸèƒ½ï¼‰
```bash
pip install pdf2image    # PDF è½¬æ¢æ”¯æŒ
pip install Pillow       # å›¾ç‰‡å¤„ç†å’Œè´¨é‡å¢å¼º
```

## é…ç½®

åˆ›å»ºé…ç½®æ–‡ä»¶ `.simacode/config.yaml`:

```yaml
# OCR é…ç½®
ocr_claudeai:
  api_key: "your-anthropic-api-key"  # æˆ–è®¾ç½®ç¯å¢ƒå˜é‡ ANTHROPIC_API_KEY
  model: "claude-3-5-sonnet-20241022"
  max_tokens: 4000
  temperature: 0.1
  timeout: 30

# å…¨å±€è®¾ç½®
max_file_size: 10485760  # 10MB
```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```python
import asyncio
from simacode.tools.universal_ocr import UniversalOCRTool, UniversalOCRInput

async def extract_text():
    # åˆå§‹åŒ–å·¥å…·
    ocr_tool = UniversalOCRTool()
    
    # åˆ›å»ºè¾“å…¥å‚æ•°
    input_data = UniversalOCRInput(
        file_path="/path/to/document.jpg",
        output_format="json"
    )
    
    # æ‰§è¡Œ OCR
    async for result in ocr_tool.execute(input_data):
        if result.type.value == "success":
            print("æå–æˆåŠŸ:")
            print(result.content)

# è¿è¡Œ
asyncio.run(extract_text())
```

### é«˜çº§ç”¨æ³•

```python
# ä½¿ç”¨åœºæ™¯æç¤ºæé«˜å‡†ç¡®æ€§
input_data = UniversalOCRInput(
    file_path="/path/to/invoice.pdf",
    output_format="structured",
    scene_hint="invoice",
    confidence_threshold=0.8,
    quality_enhancement=True
)

# è‡ªå®šä¹‰æå–æç¤º
input_data = UniversalOCRInput(
    file_path="/path/to/document.jpg",
    custom_prompt="è¯·æå–æ‰€æœ‰çš„å§“åã€æ—¥æœŸå’Œé‡‘é¢ä¿¡æ¯",
    output_format="json"
)
```

## è¾“å‡ºæ ¼å¼

### JSON æ ¼å¼
```json
{
  "meta": {
    "file_path": "/path/to/document.jpg",
    "processing_time": 2.34,
    "engine_used": "claude",
    "confidence_score": 0.95
  },
  "extracted_data": {
    "raw_text": "æå–çš„æ–‡æœ¬å†…å®¹..."
  }
}
```

### ç»“æ„åŒ–æ–‡æœ¬æ ¼å¼
```
=== OCR Extraction Results ===

ğŸ“‹ Processing Information:
  File: document.jpg
  Engine: claude
  Processing Time: 2.34s
  Confidence: 95.0%

ğŸ“ Raw Extracted Text:
æå–çš„æ–‡æœ¬å†…å®¹...
```

## çŠ¶æ€æ£€æŸ¥

```python
# æ£€æŸ¥å·¥å…·å¥åº·çŠ¶æ€
health = await ocr_tool.health_check()
print(f"å·¥å…·çŠ¶æ€: {health['tool_status']}")

# æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
stats = ocr_tool.get_statistics()
print(f"å¤„ç†ç»Ÿè®¡: {stats}")
```

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

1. **"Anthropic package not available"**
   ```bash
   pip install anthropic
   ```

2. **"pdf2image package not available"**
   ```bash
   pip install pdf2image
   ```

3. **"Claude API key not found"**
   - è®¾ç½®ç¯å¢ƒå˜é‡: `export ANTHROPIC_API_KEY=your-key`
   - æˆ–åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® `ocr_claudeai.api_key`

4. **"File too large"**
   - é»˜è®¤æœ€å¤§æ–‡ä»¶å¤§å°ä¸º 10MB
   - åœ¨é…ç½®ä¸­è°ƒæ•´ `max_file_size` å‚æ•°

## æµ‹è¯•

è¿è¡ŒåŸºæœ¬åŠŸèƒ½æµ‹è¯•:
```python
# ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
python src/simacode/tools/universal_ocr/test_basic.py
```

## Phase 1 å®ŒæˆçŠ¶æ€ âœ…

- âœ… æ ¸å¿ƒ OCR åŠŸèƒ½å®ç°
- âœ… Claude Vision å¼•æ“é›†æˆ
- âœ… æ–‡ä»¶å¤„ç†å’Œæ ¼å¼è½¬æ¢
- âœ… è¾“å…¥éªŒè¯å’Œé”™è¯¯å¤„ç†
- âœ… å¤šç§è¾“å‡ºæ ¼å¼æ”¯æŒ
- âœ… åŸºæœ¬æµ‹è¯•å’ŒéªŒè¯

## ä¸‹ä¸€æ­¥ (Phase 2)

- åœºæ™¯æ£€æµ‹å’Œæ¨¡æ¿åŒ¹é…
- å†…ç½®æ¨¡æ¿ç³»ç»Ÿ
- æ›´å¤š OCR å¼•æ“æ”¯æŒ
- æ€§èƒ½ä¼˜åŒ–
- æ‰¹é‡å¤„ç†åŠŸèƒ½

---

*Generated by Universal OCR Tool Phase 1 Development*